const mysql = require('mysql2/promise'); const path=require('path'); const upload=require('../services/QuestionsAnswers/uploadQuestionsAnswers'); (async()=>{const pool=mysql.createPool({host:process.env.DB_HOST||'localhost',user:process.env.DB_USER||'root',password:process.env.DB_PASSWORD||'',database:process.env.DB_NAME||'pcru_auto_response'}); const handler=upload(pool); const req={app:{locals:{}},user:{userId:1001,usertype:'Admin'},body:{},query:{},file:{path:path.resolve(__dirname,'tmp_questionsanswers_with_keywords.csv'),originalname:'tmp_questionsanswers_with_keywords.csv',mimetype:'text/csv'},files:undefined,headers:{}}; const res={statusCode:200,_body:null,status(code){this.statusCode=code;return this;},json(obj){this._body=obj;console.log('RESPONSE',this.statusCode,JSON.stringify(obj,null,2));return obj}}; try{await handler(req,res); console.log('Done handler'); const [krows]=await pool.query('SELECT KeywordID, KeywordText, NormalizedText, OfficerID FROM Keywords ORDER BY KeywordID DESC LIMIT 20'); console.log('Keywords:',krows); await pool.end()}catch(e){console.error(e)} })();